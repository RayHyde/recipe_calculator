$(document).ready(function(){function t(){s=[],u=[],p=[],d.find(".qty").each(function(){s.push($(this).val())}),d.find(".type").each(function(){u.push($(this).val())}),d.find(".desc").each(function(){p.push($(this).val())}),localStorage.qtys=s,localStorage.types=u,localStorage.descs=p,localStorage.orgQty=$("#orgQty").val(),localStorage.orgType=$("#orgType").val(),localStorage.newQty=$("#newQty").val(),localStorage.recipeTitle=$("#recipe-title").val()}function e(){localStorage.qtys="",localStorage.types="",localStorage.descs="",localStorage.orgQty="",localStorage.orgType="",localStorage.newQty="",localStorage.recipeTitle=""}function i(){d.find("ul").append('<li><div class="row"><div class="col-xs-2"><input type="text" placeholder="qty." id="qty-'+y+'" class="qty" name="qty" value="'+s[y]+'"></div><div class="col-xs-2"><input type="text" placeholder="e.g. gr" id="type-'+y+'" class="type" name="type" value="'+u[y]+'"></div><div class="col-xs-7"><input type="text" placeholder="e.g. flour" id="desc-'+y+'" class="desc" name="desc" value="'+p[y]+'"></div><div class="col-xs-1"><button title="Remove this ingredient" alt="Remove this ingredient" class="btn btn-default btn-sm del"><span class="glyphicon glyphicon-remove"></span></button></div></div></li>')}function n(){""!=$("#orgQty").val()&&""!=$("#newQty").val()&&""!=$("#ingredients .qty").eq($("#ingredients .qty").length-1).val()&&$("#crunch").fadeIn()}function l(){r=$("#newQty").val()/$("#orgQty").val(),$("#crunch").add(d.find("#add")).fadeOut(),$("#crunched ul, .print-text ul").remove(),d.find("ul").clone().find("li").each(function(){$(this).find(".qty").each(function(){var t=parseInt($(this).val()*r);$(this).val(t)}),$(this).find(".del").remove()}).closest("ul").appendTo(".print-text"),$("#crunched .print-header h3").text("Quantity: "+$("#newQty").val()+" "+$("#orgType").val()),$("#crunched").addClass("active")}var a,c,o,r,d=$("#ingredients"),s=[],u=[],p=[];if(localStorage&&localStorage.qtys){$("#orgQty").val(localStorage.orgQty),$("#orgType").val(localStorage.orgType),$("#newQty").val(localStorage.newQty),$("#recipe-title").val(localStorage.recipeTitle),d.find("ul li:last-child").remove(),s=localStorage.qtys.split(","),u=localStorage.types.split(","),p=localStorage.descs.split(",");for(var y=0;y<s.length;y++)i();n()}$("#add").click(function(){return a=parseInt(d.find("li:last-child .qty").attr("id").slice(-1)),d.find("li:last-child").clone().css({opacity:0}).find("input").each(function(){$(this).val("")}).closest("li").appendTo(d.find("ul")),d.find("li:last-child input").each(function(){c=$(this).attr("id").split("-")[0],$(this).attr("id",c+"-"+(a+1))}),d.find("li").eq(d.find("li").length-1).animate({opacity:1}),!1}),d.on("click",".del",function(){return o=d.find("li").length,2==o?(d.find("input").value(""),d.find("input.qty").attr("id","qty-0"),d.find("input.type").attr("id","type-0"),d.find("input.desc").attr("id","desc-0")):$(this).closest("li").animate({opacity:0},1e3,function(){$(this).remove()}),!1}),$("#crunch").click(function(){return l(),!1}),$("#reset").click(function(){function t(){d.find(".qty").length>1&&d.find(".qty").eq($("#ingredients .qty").length-1).animate({opacity:0},300,function(){d.find("li").eq($("#ingredients li").length-1).remove()})}$("#crunched").animate({opacity:0},300,function(){$(this).removeClass("active").css("opacity","1"),$("#crunched ul, .print-text ul").remove(),d.find("input").val(""),e()});setInterval(t,200)}),$("#orgQty, #newQty, #ingredients input").on("keyup",function(){n()}),$(".container").on("click","#print",function(){return $("#modalBck, #modal").addClass("active"),!1}),$("#modal #print-cont").click(function(){return window.print(),!1}),$(".save, #print-cont, #crunch").click(function(){return localStorage&&t(),!1}),$("#modal .close").click(function(){$("#modalBck, #modal").removeClass("active")})});
